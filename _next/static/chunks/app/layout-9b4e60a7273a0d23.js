(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},3971:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,9576))},9576:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,AuthProvider:()=>u});var l=r(5155),n=r(2115);let o=(0,n.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,n.useState)(null),[s,a]=(0,n.useState)(!1),[i,c]=(0,n.useState)(null),[h,d]=(0,n.useState)(!1),[m,f]=(0,n.useState)(null),[S,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=localStorage.getItem("user");e&&u(JSON.parse(e))},[]);let g=async(e,t)=>{a(!0),c(null);try{await new Promise(e=>setTimeout(e,1e3));let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),l=await r.json();if(!l.success)throw Error(l.error||"Erreur de connexion");u(l.user),localStorage.setItem("user",JSON.stringify(l.user)),d(!0);let n=Date.now();v(n),m&&clearTimeout(m);let o=setTimeout(()=>{d(!1),f(null),v(null)},4e3);f(o)}catch(e){c(e instanceof Error?e.message:"Une erreur est survenue")}finally{a(!1)}},w=async()=>{try{console.log("Initialisation d\xe9plac\xe9e c\xf4t\xe9 serveur")}catch(e){console.error("Erreur d'initialisation de la DB:",e)}};return(0,l.jsx)(o.Provider,{value:{user:r,login:g,logout:()=>{u(null),localStorage.removeItem("user"),d(!1),v(null),m&&(clearTimeout(m),f(null))},isLoading:s,error:i,showWelcome:h,hideWelcome:()=>{d(!1),v(null),m&&(clearTimeout(m),f(null))},welcomeStartTime:S,initializeDatabase:w},children:t})}function s(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[690,441,964,358],()=>e(e.s=3971)),_N_E=e.O()}]);