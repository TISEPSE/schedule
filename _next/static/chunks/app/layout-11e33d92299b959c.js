(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},3871:()=>{},4846:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,9576)),Promise.resolve().then(r.t.bind(r,3871,23))},9576:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>s});var l=r(5155),n=r(2115);let o=(0,n.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[u,i]=(0,n.useState)(!1),[a,c]=(0,n.useState)(null),[h,d]=(0,n.useState)(!1),[m,f]=(0,n.useState)(null),[v,S]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=localStorage.getItem("user");e&&s(JSON.parse(e))},[]);let g=async(e,t)=>{i(!0),c(null);try{await new Promise(e=>setTimeout(e,1e3));let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),l=await r.json();if(!l.success)throw Error(l.error||"Erreur de connexion");s(l.user),localStorage.setItem("user",JSON.stringify(l.user)),d(!0);let n=Date.now();S(n),m&&clearTimeout(m);let o=setTimeout(()=>{d(!1),f(null),S(null)},4e3);f(o)}catch(e){c(e instanceof Error?e.message:"Une erreur est survenue")}finally{i(!1)}},w=async()=>{try{console.log("Initialisation d\xe9plac\xe9e c\xf4t\xe9 serveur")}catch(e){console.error("Erreur d'initialisation de la DB:",e)}};return(0,l.jsx)(o.Provider,{value:{user:r,login:g,logout:()=>{s(null),localStorage.removeItem("user"),d(!1),S(null),m&&(clearTimeout(m),f(null))},isLoading:u,error:a,showWelcome:h,hideWelcome:()=>{d(!1),S(null),m&&(clearTimeout(m),f(null))},welcomeStartTime:v,initializeDatabase:w},children:t})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[777,441,964,358],()=>e(e.s=4846)),_N_E=e.O()}]);