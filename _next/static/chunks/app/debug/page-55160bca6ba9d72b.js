(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{4617:(e,s,t)=>{Promise.resolve().then(t.bind(t,7152))},7152:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(5155),r=t(2115);function n(){let[e,s]=(0,r.useState)([]),[t,n]=(0,r.useState)(!1),[c,i]=(0,r.useState)(""),l=async()=>{n(!0);try{let e=await fetch("/api/init-db",{method:"POST"}),s=await e.json();s.success?(i("✅ ".concat(s.message)),s.testUser&&i(e=>e+"\n\uD83D\uDCE7 Email: ".concat(s.testUser.email,"\n\uD83D\uDD11 Mot de passe: ").concat(s.testUser.password))):i("❌ ".concat(s.error))}catch(e){i("❌ Erreur: ".concat(e))}n(!1)},d=async()=>{n(!0);try{let e=await fetch("/api/init-db",{method:"DELETE"}),s=await e.json();s.success?(i("✅ ".concat(s.message)),s.testUser&&i(e=>e+"\n\uD83D\uDCE7 Email: ".concat(s.testUser.email,"\n\uD83D\uDD11 Mot de passe: ").concat(s.testUser.password))):i("❌ ".concat(s.error))}catch(e){i("❌ Erreur: ".concat(e))}n(!1)},o=async()=>{n(!0);try{let e=await fetch("/api/users"),t=await e.json();t.success?(s(t.users),i("\uD83D\uDC65 ".concat(t.users.length," utilisateur(s) trouv\xe9(s)"))):i("❌ Erreur: ".concat(t.error))}catch(e){i("❌ Erreur: ".concat(e))}n(!1)},u=async()=>{n(!0);try{let e=await fetch("/api/setup-test-data",{method:"POST"}),s=await e.json();if(s.success){if(i("✅ ".concat(s.message)),s.testCredentials){let e="\n\uD83D\uDD10 Identifiants de test cr\xe9\xe9s:\n";s.testCredentials.forEach(s=>{e+="\n".concat(s.description,":\n"),e+="\uD83D\uDCE7 Email: ".concat(s.email,"\n"),e+="\uD83D\uDD11 Mot de passe: ".concat(s.password,"\n"),e+="\uD83D\uDC64 R\xf4le: ".concat(s.role,"\n")}),i(s=>s+e)}await o()}else i("❌ ".concat(s.error))}catch(e){i("❌ Erreur: ".concat(e))}n(!1)},x=async()=>{n(!0);try{let e=await fetch("/api/diagnostic"),s=await e.json();if(s.success){let e="\uD83D\uDD0D Diagnostic de la base de donn\xe9es:\n\n";e+="\uD83D\uDC64 Utilisateurs: ".concat(s.diagnostic.users.length,"\n"),s.diagnostic.users.forEach(s=>{e+="  - ".concat(s.email," (ID: ").concat(s.id,", R\xf4le: ").concat(s.role,")\n")}),e+="\n\uD83D\uDCC5 \xc9v\xe9nements: ".concat(s.diagnostic.totalEvents,"\n"),e+="\uD83D\uDCDD Devoirs: ".concat(s.diagnostic.totalAssignments),i(e)}else i("❌ Diagnostic \xe9chou\xe9: ".concat(s.error)),s.stack&&i(e=>e+"\n\nStack trace:\n".concat(s.stack))}catch(e){i("❌ Erreur: ".concat(e))}n(!1)};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Debug - Base de donn\xe9es SQLite"}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Actions sur la base de donn\xe9es"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:l,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-xl transition-colors disabled:opacity-50",children:t?"Initialisation...":"Initialiser la DB"}),(0,a.jsx)("button",{onClick:d,disabled:t,className:"bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-6 rounded-xl transition-colors disabled:opacity-50",children:t?"Suppression...":"Vider la DB"}),(0,a.jsx)("button",{onClick:o,disabled:t,className:"bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-xl transition-colors disabled:opacity-50",children:t?"Chargement...":"Charger utilisateurs"}),(0,a.jsx)("button",{onClick:u,disabled:t,className:"bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-6 rounded-xl transition-colors disabled:opacity-50",children:t?"Cr\xe9ation...":"Cr\xe9er donn\xe9es de test"}),(0,a.jsx)("button",{onClick:x,disabled:t,className:"bg-orange-600 hover:bg-orange-700 text-white font-medium py-3 px-6 rounded-xl transition-colors disabled:opacity-50",children:t?"Diagnostic...":"Diagnostic DB"})]}),c&&(0,a.jsx)("div",{className:"bg-gray-100 rounded-xl p-4 mb-4",children:(0,a.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:c})})]}),e.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Utilisateurs dans la base"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"text-left p-2",children:"ID"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Email"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Nom"}),(0,a.jsx)("th",{className:"text-left p-2",children:"R\xf4le"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Cr\xe9\xe9 le"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,a.jsx)("td",{className:"p-2 font-mono text-xs",children:e.id}),(0,a.jsx)("td",{className:"p-2",children:e.email}),(0,a.jsxs)("td",{className:"p-2",children:[e.firstName," ",e.lastName]}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("admin"===e.role?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:e.role})}),(0,a.jsx)("td",{className:"p-2 text-xs text-gray-500",children:e.createdAt?new Date(e.createdAt).toLocaleString("fr-FR"):"N/A"})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"mt-8 bg-blue-50 rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Instructions"}),(0,a.jsxs)("div",{className:"space-y-2 text-blue-800",children:[(0,a.jsxs)("p",{children:["1. ",(0,a.jsx)("strong",{children:"Initialiser la DB"})," : Cr\xe9e les tables et un utilisateur test basique"]}),(0,a.jsxs)("p",{children:["2. ",(0,a.jsx)("strong",{children:"Vider la DB"})," : Supprime toutes les donn\xe9es"]}),(0,a.jsxs)("p",{children:["3. ",(0,a.jsx)("strong",{children:"Charger utilisateurs"})," : Affiche tous les utilisateurs de la base"]}),(0,a.jsxs)("p",{children:["4. ",(0,a.jsx)("strong",{children:"Cr\xe9er donn\xe9es de test"})," : Cr\xe9e utilisateurs, \xe9v\xe9nements et devoirs de test complets"]}),(0,a.jsx)("p",{className:"mt-4 font-semibold",children:"Utilise “Cr\xe9er donn\xe9es de test” pour avoir :"}),(0,a.jsx)("div",{className:"flex justify-center mt-2",children:(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-blue-200",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-center",children:"\uD83E\uDDEA Utilisateur de test"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-center text-blue-700",children:"test@app.com"}),(0,a.jsx)("p",{className:"text-xs text-center text-blue-600",children:"Mot de passe : test123 ou vide"})]})})]})]})]})})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=4617)),_N_E=e.O()}]);